<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<title>مسابقه جعبه جادویی | جایزه روزانه</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;700&display=swap');

    :root {
        --primary: #ff6b6b;
        --secondary: #4ecdc4;
        --dark: #1a1a2e;
        --light: #eee;
        --glow: #ffd60a;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
        font-family: 'Vazirmatn', sans-serif;
        background: linear-gradient(135deg, #0f0f1e 0%, #16213e 100%);
        color: var(--light);
        min-height: 100vh;
        overflow-x: hidden;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
    }
    h1 {
        font-size: 2.8rem;
        background: linear-gradient(90deg, #ffd60a, #ff6b6b);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin: 20px 0 10px;
        text-shadow: 0 0 30px rgba(255,107,107,0.5);
    }
    p { font-size: 1.1rem; opacity: 0.9; margin-bottom: 30px; }

    .scene {
        perspective: 1200px;
        width: 100%;
        max-width: 1000px;
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 30px;
        margin: 40px 0;
    }
    .gift-box {
        width: 100%;
        padding-bottom: 100%;
        position: relative;
        transform-style: preserve-3d;
        cursor: pointer;
        transition: all 0.4s ease;
    }
    .gift-box:hover { transform: translateY(-15px) scale(1.05); }
    .box3d {
        position: absolute;
        inset: 0;
        transform-style: preserve-3d;
        animation: float 6s infinite ease-in-out;
    }
    .side {
        position: absolute;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, var(--primary), #ff4757);
        border: 3px solid var(--glow) solid;
        box-shadow: 
            0 0 40px rgba(255,107,107,0.6),
            inset 0 0 30px rgba(255,255,255,0.2);
        backface-visibility: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 3rem;
        border-radius: 12px;
    }
    .front  { transform: translateZ(80px); }
    .back   { transform: rotateY(180deg) translateZ(80px); background: background: var(--secondary); }
    .right  { transform: rotateY(90deg) translateZ(80px); }
    .left   { transform: rotateY(-90deg) translateZ(80px); }
    .top    { transform: rotateX(90deg) translateZ(80px); background: #ffd60a; }
    .bottom { transform: rotateX(-90deg) translateZ(80px); }

    .ribbon-v { 
        position: absolute; width: 30%; height: 110%; left: 35%; top: -5%;
        background: var(--glow); box-shadow: 0 0 20px #ffd60a;
    }
    .ribbon-h { 
        position: absolute; width: 110%; height: 30%; left: -5%; top: 35%;
        background: var(--glow); box-shadow: 0 0 20px #ffd60a;
    }
    .bow {
        position: absolute;
        width: 60px; height: 60px;
        background: var(--glow);
        border-radius: 50%;
        top: -30px; left: 50%; transform: translateX(-50%);
        box-shadow: 0 0 30px #ffd60a;
    }
    .bow::before, .bow::after {
        content: ''; position: absolute;
        width: 80px; height: 40px;
        background: var(--glow);
        border-radius: 50%;
        top: 10px;
    }
    .bow::before { left: -50px; transform: rotate(-30deg); }
    .bow::after { right: -50px; transform: rotate(30deg); }

    .opened .box3d { animation: openBox 2s forwards; }
    @keyframes openBox {
        0%   { transform: rotateY(0) scale(1); }
        50%  { transform: rotateY(720deg) scale(1.4); }
        100% { transform: rotateY(0) scale(0); opacity: 0; }
    }

    #win-screen {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.92);
        display: none;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        z-index: 999;
        backdrop-filter: blur(10px);
    }
    #prize-text {
        font-size: 3.5rem;
        font-weight: bold;
        background: linear-gradient(45deg, #ffd60a, #ff6b6b, #4ecdc4);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        animation: glowText 2s infinite alternate;
        margin-bottom: 30px;
    }
    @keyframes glowText { from { filter: drop-shadow(0 0 20px #ffd60a); } to { filter: drop-shadow(0 0 60px #ff6b6b); } }

    .firework {
        position: absolute;
        width: 8px; height: 8px;
        border-radius: 50%;
        animation: firework 1.5s forwards;
    }
    @keyframes firework {
        0% { transform: scale(0); opacity: 1; }
        100% { transform: translate(var(--x), var(--y)) scale(3); opacity: 0; }
    }

    .telegram-btn {
        padding: 15px 40px;
        font-size: 1.4rem;
        background: linear-gradient(45deg, #4ecdc4, #44a08d);
        border: none;
        border-radius: 50px;
        color: white;
        cursor: pointer;
        box-shadow: 0 10px 30px rgba(78,205,196,0.4);
        transition: 0.3s;
    }
    .telegram-btn:hover { transform: scale(1.1); }

    #admin-link { margin-top: 30px; font-size: 0.9rem; opacity: 0.6; cursor: pointer; }
    #admin-panel { display: none; background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; backdrop-filter: blur(10px); margin-top: 20px; width: 90%; max-width: 600px; }

    @keyframes float {
        0%,100% { transform: translateY(0) rotateY(0); }
        50% { transform: translateY(-20px) rotateY(10deg); }
    }
</style>
</head>
<body>

<h1>مسابقه جعبه جادویی</h1>
<p>هر ۲۴ ساعت یک‌بار شانس خودت رو امتحان کن!</p>

<div class="scene" id="boxes"></div>

<div id="win-screen">
    <div id="prize-text" id="prize-text"></div>
    <p style="font-size:1.3rem;margin:20px 0;">اسکرین‌شات بگیر و برای دریافت جایزه به تلگرام بفرست</p>
    <a href="https://t.me/Mahdi7ai" target="_blank">
        <button class="telegram-btn">ارسال به @Mahdi7ai</button>
    </a>
</div>

<div id="admin-link" onclick="adminLogin()">پنل مدیریت (فقط ادمین)</div>
<div id="admin-panel"></div>

<script>
const ADMIN_PASS = "100700";
let prizes = JSON.parse(localStorage.getItem("daily_prizes_v2")) || [
    {name: "50٪ تخفیف دوره ادمین طراح", chance: 12},
    {name: "40٪ تخفیف دوره هوش مصنوعی", chance: 15},
    {name: "70٪ تخفیف استوری موشن", chance: 8},
    {name: "اکانت ۱ ماهه کپ‌کات پرمیوم", chance: 18},
    {name: "۱ ساعت مشاوره رایگان", chance: 10},
    {name: "60٪ تخفیف روی هر دوره", chance: 15},
    {name: "پک آیکون‌های سه‌بعدی", chance: 12},
    {name: "۳۰۰ هزار تومان نقدی", chance: 10}
];

function createBox(i) {
    const box = document.createElement("div");
    box.className = "gift-box";
    box.innerHTML = `
        <div class="box3d">
            <div class="side front">جعبه ${i+1}</div>
            <div class="side back">باز شد!</div>
            <div class="side right"></div>
            <div class="side left"></div>
            <div class="side top"></div>
            <div class="side bottom"></div>
            <div class="ribbon-v"></div>
            <div class="ribbon-h"></div>
            <div class="bow"></div>
        </div>
    `;
    box.onclick = () => openBox(box);
    return box;
}

function init() {
    const container = document.getElementById("boxes");
    for(let i=0; i<8; i++) container.appendChild(createBox(i));

    const last = localStorage.getItem("lastOpen");
    if (last && Date.now() - last < 24*60*60*1000) {
        document.querySelectorAll(".gift-box").forEach(b => b.style.pointerEvents = "none");
        alert("شما امروز جایزه گرفتی! فردا دوباره بیا");
    }
}

function openBox(el) {
    if (el.classList.contains("opened")) return;
    el.classList.add("opened");
    el.style.pointerEvents = "none";

    setTimeout(() => {
        const prize = getPrize();
        document.getElementById("prize-text").textContent = prize;
        document.getElementById("win-screen").style.display = "flex";
        localStorage.setItem("lastOpen", Date.now());
        createFireworks();
    }, 2000);
}

function getPrize() {
    const total = prizes.reduce((a,b)=>a+b.chance,0);
    let r = Math.random() * total;
    for (let p of prizes) {
        r -= p.chance;
        if (r <= 0) return p.name;
    }
}

function createFireworks() {
    for(let i=0; i<60; i++) {
        const fw = document.createElement("div");
        fw.className = "firework";
        fw.style.background = ["#ffd60a","#ff6b6b","#4ecdc4","#ff9ff3"][Math.floor(Math.random()*4)];
        fw.style.left = Math.random()*100 + "vw";
        fw.style.top = Math.random()*100 + "vh";
        fw.style.setProperty("--x", (Math.random()-0.5)*400 + "px");
        fw.style.setProperty("--y", (Math.random()-0.5)*400 + "px");
        document.body.appendChild(fw);
        setTimeout(()=>fw.remove(), 2000);
    }
}

function adminLogin() {
    const pass = prompt("رمز مدیریت:");
    if (pass === ADMIN_PASS) showAdminPanel();
    else alert("اشتباهه!");
}

function showAdminPanel() {
    const panel = document.getElementById("admin-panel");
    panel.style.display = "block";
    panel.innerHTML = `<h3>تنظیم جوایز (فقط ادمین)</h3>`;
    prizes.forEach((p,i) => {
        panel.innerHTML += `
            <div style="display:flex;gap:10px;margin:10px 0;align-items:center;">
                <input type="text" value="${p.name}" style="flex:1;padding:8px;border-radius:8px;border:none;">
                <input type="number" value="${p.chance}" style="width:80px;padding:8px;border-radius:8px;border:none;" min="1">
                <span>%</span>
            </div>`;
    });
    panel.innerHTML += `<button onclick="savePrizes()" style="margin-top:15px;padding:10px 30px;background:#4ecdc4;border:none;border-radius:50px;color:white;cursor:pointer;">ذخیره</button>`;
    panel.querySelectorAll("input[type=text]").forEach((inp,idx)=> inp.onchange = e => prizes[idx].name = e.target.value);
    panel.querySelectorAll("input[type=number]").forEach((inp,idx)=> inp.onchange = e => prizes[idx].chance = +e.target.value);
}

function savePrizes() {
    localStorage.setItem("daily_prizes_v2", JSON.stringify(prizes));
    alert("جوایز با موفقیت ذخیره شد!");
}

init();
</script>
</body>
</html>
